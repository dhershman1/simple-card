!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("kyanite/or"),require("kyanite/type"),require("kyanite/find"),require("kyanite/range"),require("kyanite/some"),require("kyanite/and"),require("kyanite/not"),require("kyanite/assign"),require("kyanite/every")):"function"==typeof define&&define.amd?define(["exports","kyanite/or","kyanite/type","kyanite/find","kyanite/range","kyanite/some","kyanite/and","kyanite/not","kyanite/assign","kyanite/every"],r):r(e.simpleCard={},e.or,e.type,e.find,e.range,e.some,e.and,e.not,e.assign,e.every)}(this,function(e,i,l,n,a,o,u,c,t,d){"use strict";i=i&&i.hasOwnProperty("default")?i.default:i,l=l&&l.hasOwnProperty("default")?l.default:l,n=n&&n.hasOwnProperty("default")?n.default:n,a=a&&a.hasOwnProperty("default")?a.default:a,o=o&&o.hasOwnProperty("default")?o.default:o,u=u&&u.hasOwnProperty("default")?u.default:u,c=c&&c.hasOwnProperty("default")?c.default:c,t=t&&t.hasOwnProperty("default")?t.default:t,d=d&&d.hasOwnProperty("default")?d.default:d;var f=function(e){return i("String"===l(e),"Number"===l(e))},s=function(e){if(!f(e))throw new TypeError("cvn should be a string or number type");var r=String(e).replace(/\D/g,""),t="Invalid CVN Code";return 3===r.length?t="norm":4===r.length&&(t="amex"),{isValid:"Invalid CVN Code"!==t,cvnType:t}};function y(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==u.return||u.return()}finally{if(a)throw i}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function p(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var h=function(e){if("String"!==l(e))throw new TypeError("date should be a string type");var r,t=new Date,n=y(e.replace(/\s/g,"").split(/\W/g),2),a=n[0],i=n[1],o=new Date("".concat(t.getMonth()+1,"/1/").concat(t.getFullYear())),u=new Date("".concat(a,"/1/").concat(2===(r=i).length?"".concat(String((new Date).getFullYear()).slice(0,2)).concat(r):r)),c=!!isNaN(u)||u<o;return{isValid:!c,isExpired:c}},g=function(r){var t={amex:[34,37],discover:[6011].concat(p(a(622126,622926)),p(a(644,650)),[65]),master:a(50,56),visa:[4]};return n(function(e){return o(function(e){return new RegExp("^".concat(e)).test(r)},t[e])},Object.keys(t))},v=function(e,r){if(i(!f(e),!f(r)))throw new TypeError("cvn and card number should be string or number types");var t=String(e).replace(/\D/g,"").length,n=g(String(r).replace(/\D/g,"")),a=c(i(u(4===t,"amex"!==n),u(3===t,"amex"===n)));return{isValid:a,match:a?"card type matches cvn":"cvn does not match card type"}},m=function(e){if(!f(e))throw new TypeError("number should be a string or number type");var r=String(e).replace(/\D/g,""),t=Boolean(function(e){if(/[^0-9-\s]+/.test(e))return!1;for(var r=[0,2,4,6,8,1,3,5,7,9],t=e.length,n=1,a=0,i=0;t;)i=parseInt(e.charAt(--t),10),a+=(n^=1)?r[i]:i;return a&&a%10==0}(r));return{isValid:t,cardType:t?g(r):"Invalid Card Number"}};e.cvn=s,e.expired=h,e.matches=v,e.number=m,e.validate=function(e){if("Object"!==l(e))throw new TypeError("Must send full card object to run full validation");var r=[m(e.number),s(e.cvn),h(e.date),v(e.cvn,e.number)];return t.apply(void 0,[{}].concat(r,[{isValid:d(function(e){return e.isValid},r)}]))},Object.defineProperty(e,"__esModule",{value:!0})});
